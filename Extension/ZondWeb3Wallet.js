const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["Header.js","index.js","index.css","Body.js"])))=>i.map(i=>d[i]);
import{c as L,o as j,u as C,r as i,a as ve,b as ge,S as O,R as Te,j as e,C as Z,d as be,e as Se,f as _e,g as J,h as ee,B as P,i as ye,k as Ee,l as we,P as se,m as W,n as Ae,p as Re,q as V,z as K,T as De,s as ke,t as Oe,v as Pe,L as Y,w as Fe,x as te,_ as ae}from"./index.js";import{A as Ie,a as ze,b as Le,c as Ze,d as Me}from"./AlertDialog.js";import{T as Be,a as qe,b as $,c as X,C as Ue}from"./ConnectionBadge.js";import{C as M}from"./check.js";import{S as He}from"./Separator.js";import{A as Ge,a as We,b as Ve}from"./Alert.js";import{A as Ke}from"./AccountId.js";import{u as Ye,F as $e,a as Xe,b as Qe,c as Je,I as es,d as ss,e as ts,t as as}from"./zod.js";import{S as Q}from"./stringUtil.js";import{C as ns}from"./copy.js";import{L as R}from"./loader.js";import{X as os}from"./x.js";import"./index2.js";import"./Dialog.js";/**
 * @license lucide-react v0.400.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rs=L("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.400.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cs=L("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.400.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const is=L("ShieldAlert",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]]),ls=j(()=>{const{zondStore:t}=C(),{zondConnection:s}=t,{isConnected:a}=s,[n,m]=i.useState(!1),c=ve(),{pathname:l}=ge();return i.useEffect(()=>{(async()=>{const o=await O.getActivePage();o&&a?(await O.clearActivePage(),m(!0),c(o)):!o&&a?m(!0):c(Te.HOME)})()},[a]),i.useEffect(()=>{window.scrollTo(0,0),(async()=>n&&await O.setActivePage(l))()},[l]),null}),ds=j(()=>{const{dAppRequestStore:t}=C(),{approvalProcessingStatus:s}=t,{hasApproved:a}=s;return i.useEffect(()=>{window.scrollTo(0,0)},[]),e.jsx(e.Fragment,{children:e.jsxs(Z,{className:"w-full",children:[e.jsxs(be,{children:[e.jsxs(Se,{children:["Request ",a?"approved":"rejected"]}),e.jsxs(_e,{children:["The request has been ",a?"approved":"rejected"]})]}),e.jsx(J,{children:e.jsx("div",{className:"flex justify-center",children:a?e.jsx(rs,{className:"h-16 w-16"}):e.jsx(cs,{className:"h-16 w-16"})})}),e.jsxs(ee,{className:"grid grid-cols-2 gap-4",children:[e.jsx("div",{}),e.jsxs(P,{className:"w-full",type:"button",onClick:()=>{window.close()},children:[e.jsx(M,{className:"mr-2 h-4 w-4"}),"Done"]})]})]})})}),us=Object.freeze({ZOND_WEB3_WALLET_GET_PROVIDER_STATE:"zondWallet_getProviderState",ZOND_GET_BLOCK_BY_NUMBER:"zond_getBlockByNumber",NET_VERSION:"net_version",ZOND_ACCOUNTS:"zond_accounts",WALLET_REVOKE_PERMISSIONS:"wallet_revokePermissions",ZOND_GET_BALANCE:"zond_getBalance",ZOND_ESTIMATE_GAS:"zond_estimateGas",ZOND_BLOCK_NUMBER:"zond_blockNumber",ZOND_GET_TRANSACTION_RECEIPT:"zond_getTransactionReceipt",ZOND_GET_TRANSACTION_BY_HASH:"zond_getTransactionByHash",ZOND_CALL:"zond_call",ZOND_GET_CODE:"zond_getCode"}),z=Object.freeze({ZOND_REQUEST_ACCOUNTS:"zond_requestAccounts",ZOND_SEND_TRANSACTION:"zond_sendTransaction"});Object.values({...z,...us});function ms(t){const s=i.useRef({value:t,previous:t});return i.useMemo(()=>(s.current.value!==t&&(s.current.previous=s.current.value,s.current.value=t),s.current.previous),[t])}var B="Checkbox",[xs,qs]=ye(B),[hs,fs]=xs(B),ne=i.forwardRef((t,s)=>{const{__scopeCheckbox:a,name:n,checked:m,defaultChecked:c,required:l,disabled:o,value:d="on",onCheckedChange:x,form:h,...u}=t,[f,r]=i.useState(null),T=Ee(s,p=>r(p)),S=i.useRef(!1),D=f?h||!!f.closest("form"):!0,[v=!1,_]=we({prop:m,defaultProp:c,onChange:x}),F=i.useRef(v);return i.useEffect(()=>{const p=f==null?void 0:f.form;if(p){const b=()=>_(F.current);return p.addEventListener("reset",b),()=>p.removeEventListener("reset",b)}},[f,_]),e.jsxs(hs,{scope:a,state:v,disabled:o,children:[e.jsx(se.button,{type:"button",role:"checkbox","aria-checked":g(v)?"mixed":v,"aria-required":l,"data-state":ce(v),"data-disabled":o?"":void 0,disabled:o,value:d,...u,ref:T,onKeyDown:W(t.onKeyDown,p=>{p.key==="Enter"&&p.preventDefault()}),onClick:W(t.onClick,p=>{_(b=>g(b)?!0:!b),D&&(S.current=p.isPropagationStopped(),S.current||p.stopPropagation())})}),D&&e.jsx(ps,{control:f,bubbles:!S.current,name:n,value:d,checked:v,required:l,disabled:o,form:h,style:{transform:"translateX(-100%)"},defaultChecked:g(c)?!1:c})]})});ne.displayName=B;var oe="CheckboxIndicator",re=i.forwardRef((t,s)=>{const{__scopeCheckbox:a,forceMount:n,...m}=t,c=fs(oe,a);return e.jsx(Ae,{present:n||g(c.state)||c.state===!0,children:e.jsx(se.span,{"data-state":ce(c.state),"data-disabled":c.disabled?"":void 0,...m,ref:s,style:{pointerEvents:"none",...t.style}})})});re.displayName=oe;var ps=t=>{const{control:s,checked:a,bubbles:n=!0,defaultChecked:m,...c}=t,l=i.useRef(null),o=ms(a),d=Re(s);i.useEffect(()=>{const h=l.current,u=window.HTMLInputElement.prototype,r=Object.getOwnPropertyDescriptor(u,"checked").set;if(o!==a&&r){const T=new Event("click",{bubbles:n});h.indeterminate=g(a),r.call(h,g(a)?!1:a),h.dispatchEvent(T)}},[o,a,n]);const x=i.useRef(g(a)?!1:a);return e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:m??x.current,...c,tabIndex:-1,ref:l,style:{...t.style,...d,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function g(t){return t==="indeterminate"}function ce(t){return g(t)?"indeterminate":t?"checked":"unchecked"}var ie=ne,Ns=re;const le=i.forwardRef(({className:t,...s},a)=>e.jsx(ie,{ref:a,className:V("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",t),...s,children:e.jsx(Ns,{className:V("flex items-center justify-center text-current"),children:e.jsx(M,{className:"h-4 w-4"})})}));le.displayName=ie.displayName;const js=j(()=>{const{zondStore:t,dAppRequestStore:s}=C(),{zondAccounts:a}=t,{accounts:n,isLoading:m}=a,c=n.map(u=>u.accountAddress),{addToResponseData:l,setCanProceed:o}=s,[d,x]=i.useState({accounts:[]});i.useEffect(()=>{l({...d})},[d]);const h=(u,f)=>{let r=d.accounts;f?r=Array.from(new Set([...r,u])):r=r.filter(T=>T!==u),o(r.length>0),x({accounts:[...r]})};return e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold",children:"Connect with Wallet"}),e.jsx("div",{children:"Select the accounts you want this site to connect with"})]}),e.jsx("div",{className:"flex flex-col gap-4",children:m?e.jsx("div",{className:"flex h-12 w-full animate-pulse items-center justify-between",children:e.jsx("div",{className:"h-full w-full rounded-md bg-accent"})}):c.length?c.map(u=>e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(le,{id:u,onCheckedChange:f=>h(u,!!f)}),e.jsx("label",{htmlFor:u,className:"cursor-pointer text-xs font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:e.jsx(Ke,{account:u})})]})):e.jsx("div",{children:"No accounts available to connect"})}),e.jsxs(Ge,{className:"mt-2",children:[e.jsx(is,{className:"h-4 w-4"}),e.jsx(We,{children:"Careful!"}),e.jsx(Ve,{className:"text-xs",children:"There are token approval scams out there. Ensure you only connect your wallet with the websites you trust."})]})]})}),Cs=K.object({mnemonicPhrases:K.string().min(1,"Mnemonic phrases are required")}),vs=j(({transactionType:t})=>{const{zondStore:s,dAppRequestStore:a}=C(),{zondInstance:n,getGasFeeData:m,zondConnection:c}=s,{isConnected:l}=c,{dAppRequestData:o,setOnPermissionCallBack:d,setCanProceed:x,addToResponseData:h,approvalProcessingStatus:u}=a,{isProcessing:f}=u,r=o==null?void 0:o.params[0],T=r==null?void 0:r.from,{prefix:S,addressSplit:D}=Q.getSplitAddress(T),v=r==null?void 0:r.to,{prefix:_,addressSplit:F}=Q.getSplitAddress(v),p=BigInt(r==null?void 0:r.value),b=BigInt(r==null?void 0:r.gas),q=r==null?void 0:r.data;i.useEffect(()=>{l&&d(async I=>{I&&await ue()})},[l]);const de=()=>{navigator.clipboard.writeText(q)},ue=async()=>{var G;const y=(G=o==null?void 0:o.params)==null?void 0:G[0],I=me().mnemonicPhrases.trim();try{const{from:E,data:he,gas:fe,type:pe,value:Ne}=y,je=await(n==null?void 0:n.getGasPrice());let w={from:E,data:he,gas:fe,value:Ne,nonce:await(n==null?void 0:n.getTransactionCount(E))};if(pe==="0x2"){const{maxFeePerGas:A,maxPriorityFeePerGas:Ce}=await m();w.type="0x2",w.maxPriorityFeePerGas=Ce,w.maxFeePerGas=`0x${A.toString(16)}`}else w.gasPrice=je;const k=await(n==null?void 0:n.accounts.signTransaction(w,Fe(I)));if(k){const A=await(n==null?void 0:n.sendSignedTransaction(k==null?void 0:k.rawTransaction));h({transactionHash:A==null?void 0:A.transactionHash})}else throw new Error("Transaction could not be signed")}catch(E){h({error:E}),console.error("Contract deployment failed:",E)}},U=Ye({resolver:as(Cs),mode:"onChange",reValidateMode:"onSubmit",defaultValues:{mnemonicPhrases:""}}),{watch:me,control:xe,formState:{isValid:H}}=U;return i.useEffect(()=>{x(H)},[H]),e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsxs(Be,{defaultValue:"details",className:"w-full",children:[e.jsxs(qe,{children:[e.jsx($,{value:"details",className:"data-[state=active]:text-secondary",children:"Details"}),t!==N.ZND_TRANSFER&&e.jsx($,{value:"data",className:"data-[state=active]:text-secondary",children:"Data"})]}),e.jsx(X,{value:"details",className:"rounded-md bg-muted p-2",children:e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("div",{children:"From address"}),e.jsx("div",{className:"w-64 font-bold text-secondary",children:`${S} ${D.join(" ")}`})]}),(t===N.CONTRACT_INTERACTION||t===N.ZND_TRANSFER)&&e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsxs("div",{children:[t===N.CONTRACT_INTERACTION?"Contract ":"To ","address"]}),e.jsx("div",{className:"w-64 font-bold text-secondary",children:`${_} ${F.join(" ")}`})]}),t===N.ZND_TRANSFER&&e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("div",{children:"Value"}),e.jsx("div",{className:"font-bold text-secondary",children:p.toString()})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("div",{children:"Gas Limit"}),e.jsx("div",{className:"font-bold text-secondary",children:b.toString()})]})]})}),t!==N.ZND_TRANSFER&&e.jsx(X,{value:"data",className:"rounded-md bg-muted p-2",children:e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("div",{children:"Data"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"max-h-[8rem] w-full overflow-hidden break-words font-bold text-secondary",children:q}),e.jsx(De,{children:e.jsxs(ke,{delayDuration:0,children:[e.jsx(Oe,{asChild:!0,children:e.jsx(P,{className:"w-12 hover:text-secondary",variant:"outline",size:"icon",onClick:de,children:e.jsx(ns,{size:"18"})})}),e.jsx(Pe,{side:"bottom",children:e.jsx(Y,{children:"Copy Data"})})]})})]})]})})]}),e.jsx($e,{...U,children:e.jsx("form",{name:"zondSendTransactionContractDeployment","aria-label":"zondSendTransactionContractDeployment",className:"w-full",children:e.jsx(Xe,{control:xe,name:"mnemonicPhrases",render:({field:y})=>e.jsxs(Qe,{children:[e.jsx(Y,{children:"Mnemonic phrases"}),e.jsx(Je,{children:e.jsx(es,{...y,"aria-label":y.name,autoComplete:"off",disabled:f,placeholder:"Mnemonic Phrases"})}),e.jsx(ss,{children:"Paste the mnemonic phrases"}),e.jsx(ts,{})]})})})})]})}),N={CONTRACT_DEPLOYMENT:"CONTRACT_DEPLOYMENT",CONTRACT_INTERACTION:"CONTRACT_INTERACTION",ZND_TRANSFER:"ZND_TRANSFER",UNKNOWN:"UNKNOWN"},gs=j(()=>{const{dAppRequestStore:t}=C(),{dAppRequestData:s}=t;let a="",n="";const m=c(s==null?void 0:s.params[0]);function c(l){if(!l||typeof l!="object")return N.UNKNOWN;const{to:o,value:d,data:x}=l;return!o&&x?(a="Deploy a contract",n="This site wants to deploy a contract",N.CONTRACT_DEPLOYMENT):o&&x?(a="Interact with a contract",n="This site wants to interact with a contract",N.CONTRACT_INTERACTION):o&&d&&!x?(a="Transfer ZND",n="This site wants to send ZND",N.ZND_TRANSFER):N.UNKNOWN}return e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold",children:a}),e.jsx("div",{children:n})]}),e.jsx("div",{className:"flex flex-col gap-4",children:e.jsx(vs,{transactionType:m})})]})}),Ts=j(()=>{const{dAppRequestStore:t}=C(),{dAppRequestData:s}=t;switch(s==null?void 0:s.method){case z.ZOND_REQUEST_ACCOUNTS:return e.jsx(js,{});case z.ZOND_SEND_TRANSACTION:return e.jsx(gs,{});default:return e.jsx(e.Fragment,{})}}),bs=j(()=>{var m,c,l,o,d,x,h,u;const{dAppRequestStore:t}=C(),{dAppRequestData:s}=t,n=new URL(((c=(m=s==null?void 0:s.requestData)==null?void 0:m.senderData)==null?void 0:c.url)??"").origin;return e.jsxs(Z,{className:"flex flex-col gap-4 p-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("img",{className:"h-6 w-6",src:(o=(l=s==null?void 0:s.requestData)==null?void 0:l.senderData)==null?void 0:o.favIconUrl,alt:(x=(d=s==null?void 0:s.requestData)==null?void 0:d.senderData)==null?void 0:x.title}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-bold",children:n}),e.jsx("span",{className:"text-xm opacity-80",children:(u=(h=s==null?void 0:s.requestData)==null?void 0:h.senderData)==null?void 0:u.title})]})]}),e.jsx(He,{}),e.jsx(Ts,{})]})}),Ss=j(()=>{const{zondStore:t,dAppRequestStore:s}=C(),{zondConnection:a}=t,{isLoading:n,isConnected:m}=a,{onPermission:c,canProceed:l,approvalProcessingStatus:o}=s,{isProcessing:d,hasApproved:x,hasCompleted:h}=o,u=d&&!x,f=d&&x;return n?e.jsx("div",{className:"flex justify-center pt-48",children:e.jsx(R,{className:"animate-spin",size:86})}):m?e.jsxs(e.Fragment,{children:[e.jsx("img",{className:"fixed z-0 h-96 w-96 -translate-x-8 animate-rotate-scale overflow-hidden opacity-30",src:"tree.svg"}),e.jsx("div",{className:"relative z-10 flex flex-col items-center space-y-4 p-4",children:h?e.jsx(ds,{}):e.jsxs(e.Fragment,{children:[e.jsxs(Z,{className:"w-full",children:[e.jsx("div",{className:"flex justify-center pt-6",children:e.jsx(Ue,{isDisabled:!0})}),e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"mb-1 text-xs font-bold",children:"Your permission required"}),e.jsx("div",{children:"Here is a request coming in. Go through the details and decide if it needs to be allowed."})]}),e.jsxs(J,{className:"space-y-6",children:[e.jsx(bs,{}),e.jsx("div",{className:"font-bold",children:"Do you trust and want to allow this?"})]}),e.jsxs(ee,{className:"grid grid-cols-2 gap-4",children:[e.jsxs(P,{className:"w-full",variant:"outline",type:"button",disabled:d,onClick:()=>c(!1),children:[u?e.jsx(R,{className:"mr-2 h-4 w-4 animate-spin"}):e.jsx(os,{className:"mr-2 h-4 w-4"}),"No"]}),e.jsxs(P,{className:"w-full",type:"button",disabled:!l||d,onClick:()=>c(!0),children:[f?e.jsx(R,{className:"mr-2 h-4 w-4 animate-spin"}):e.jsx(M,{className:"mr-2 h-4 w-4"}),"Yes"]})]})]}),e.jsx(Ie,{open:d,children:e.jsx(ze,{className:"w-80 rounded-md",children:e.jsxs(Le,{className:"text-left",children:[e.jsx(Ze,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(R,{className:"animate-spin text-foreground",size:"18"}),"Transaction running"]})}),e.jsx(Me,{children:"Please wait. This may take a while."})]})})})]})})]}):e.jsx("div",{className:"flex justify-center pt-48",children:"Connection not available!"})}),_s=j(()=>{const{dAppRequestStore:t}=C(),{dAppRequestData:s,readDAppRequestData:a}=t;return i.useEffect(()=>{a()},[]),s?e.jsx(Ss,{}):e.jsx("div",{className:"flex justify-center pt-48",children:e.jsx(R,{className:"animate-spin",size:86})})}),ys=te(i.lazy(()=>ae(()=>import("./Header.js"),__vite__mapDeps([0,1,2])))),Es=te(i.lazy(()=>ae(()=>import("./Body.js"),__vite__mapDeps([3,1,2])))),Us=j(()=>{const[t,s]=i.useState(!0);return i.useEffect(()=>{(async()=>{const a=await O.getDAppRequestData();s(!!a)})()},[]),e.jsxs("div",{className:"flex min-h-[48rem] w-[23rem] flex-col overflow-x-hidden bg-background text-foreground",children:[e.jsx(ls,{}),t?e.jsx(_s,{}):e.jsxs(e.Fragment,{children:[e.jsx(ys,{}),e.jsx(Es,{})]})]})});export{Us as default};
